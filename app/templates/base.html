<!DOCTYPE html>
<html lang="{{ get_locale }}">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="shortcut icon" href="/static/favicon.ico"/>

    <title>{% if title is defined %}{{ title }}{% else %}pyEncode{% endif %}</title>

    {% assets (CSS_NAME if CSS_NAME else "base.css") %}
        <link rel="stylesheet" href="{{ ASSET_URL }}"/>
    {% endassets %}

    <script>
        var currentPath = "{{ '/filemanager' + path if path else '' }}";

        var lang = {
            success: "{{ _('Success') }}",
            process_cancel_success: "{{ _('The processes were cancelled successfully.') }}",
            error: "{{ _('Error') }}",
            warning: "{{ _('Warning') }}",
            not_all_fields_filled: "{{ _('Not all required fields were filled!') }}",
            package_added_successfully: "{{ _('The package was added successfully.') }}",
            duplicate_file_error: "{{ _('At least one file was added already!') }}",
            at_least_one_file_not_existing: "{{ _('At least one file does not exist!') }}",
            deleting_package_successful: "{{ _('The package has been deleted successfully.') }}",
            moving_package_successful: "{{ _('The package has been moved successfully.') }}",
            cant_open_folder: "{{ _('Can\'t open that folder!') }}",
				is_already_in_list: "{{ _('is already in your list!') }}",
				unknown_error_occured: "{{ _('An unknown error occured!') }}",
				file_has_been_added_successfully: "{{ _('The file has been added successfully.') }}",
				files_were_added_successfully: "{{ _('The files were added successfully.') }}"
			}
		</script>

		{% assets (JS_NAME if JS_NAME else "base.js") %}
		<script src="{{ ASSET_URL }}" async></script>
		{% endassets %}
	</head>
	<body{% if filemanager is defined %} class="filemanager"{% endif %}>
		{% if not filemanager is defined %}
		<nav class="navbar navbar-static-top navbar-default" role="navigation">
			<div class="container">
				<div class="navbar-header">
					<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
						<span class="sr-only">Toggle navigation</span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
					<a class="navbar-brand" href="{{ url_for("mod_index.index") }}">
						<i class="fa fa-fw fa-file-video-o"></i> pyEncode
					</a>
				</div>
				<div class="collapse navbar-collapse">
					<ul class="nav navbar-nav">
						{% if current_user.is_anonymous %}
							<li class="active">
								<a href="/login">
									<i class="fa fa-fw fa-unlock"></i> {{ _("Login") }}
								</a>
							</li>
						{% else %}
							<li{% if request.path == "/" %} class="active"{% endif %}>
								<a href="{{ url_for("overview") }}">
									<i class="fa fa-fw fa-eye"></i> {{ _("Overview") }}
								</a>
							</li>
							<li{% if request.path == url_for("show_list", which="queue") %} class="active"{% endif %}>
								<a href="{{ url_for("show_list", which="queue") }}">
									<i class="fa fa-fw fa-inbox"></i> {{ _("Packages") }}
								</a>
							</li>
							<li{% if request.path == url_for("show_list", which="collector") %} class="active"{% endif %}>
								<a href="{{ url_for("show_list", which="collector") }}">
									<i class="fa fa-fw fa-shopping-cart"></i> {{ _("Collector") }}
								</a>
							</li>
						{% endif %}
					</ul>
					<ul class="nav navbar-nav navbar-right">
						<li class="dropdown">
							<a href="#" class="dropdown-toggle" data-toggle="dropdown">
								<i class="fa fa-fw fa-language"></i> {{ _("Language") }} <span class="caret"></span>
							</a>
							<ul class="dropdown-menu" role="menu">
								<li{{ ' class="active"'|safe if get_locale == 'de' else '' }}>
									<a href="{# url_for("set_language", language="de") #}">
										<i class="fa flag flag-de"></i> {{ _("German") }}
									</a>
								</li>
								<li{{ ' class="active"'|safe if get_locale == "en" else "" }}>
									<a href="{# url_for("set_language", language="en") #}">
										<i class="fa flag flag-us"></i> {{ _("English") }}
									</a>
								</li>
							</ul>
						</li>
						{% if not current_user.is_anonymous %}
							<li{% if request.path == url_for("settings_page") %} class="active"{% endif %}>
								<a href="{{ url_for("settings_page") }}">
									<i class="fa fa-fw fa-cogs"></i> {{ _("Settings") }}
								</a>
							</li>
							<li{% if request.path == url_for("log_page") %} class="active"{% endif %}>
								<a href="{{ url_for("log_page") }}">
									<i class="fa fa-fw fa-file-text-o"></i> {{ _("Log") }}
								</a>
							</li>
							<li>
								<a href="{{ url_for("logout") }}">
									<i class="fa fa-fw fa-lock"></i> {{ _("Logout") }}
								</a>
							</li>
						{% endif %}
					</ul>
				</div>
				<!--/.nav-collapse -->
			</div>
		</nav>
		{% endif %}
		<div class="container">
			{% block content %}{% endblock %}
		</div>
		{% if not current_user.is_anonymous and not filemanager is defined %}
		<div class="navbar navbar-fixed-bottom navbar-default" role="navigation">
			<div class="container"> <!-- oder: container-fluid? -->
				<div style="margin: 15px 0 15px 15px;">
					<div class="btn-toolbar">
						<div class="btn-group text-center">
							<button class="btn btn-default btn-sm" disabled="disabled"><span id="currentlyActive">{{ currentlyActive }}</span> / <span id="currentlyTotal">{{ currentlyTotal }}</span></button>
							{% set status_active = encoding_active %}
							{# only run query once #}
							<button class="btn btn-{% if not status_active %}danger{% else %}success{% endif %} btn-sm control" onclick="toggle_status();">
								<i class="fa fa-info"></i>&nbsp;
								<span class="{% if not status_active %}hidden{% endif %}" data-which="1">{{ _("Activated") }}</span>
								<span class="{% if status_active %}hidden{% endif %}" data-which="0">{{ _("Deactivated") }}</span>
							</button>
						</div>
						<div class="btn-group text-center">
							<button id="addPackageBtn" class="btn btn-primary btn-sm">
								<i class="fa fa-film"></i> <span>&nbsp;{{ _("Add Package") }}</span>
							</button>
						</div>
						<div class="btn-group text-center">
							<button onclick="cancel_process(this);" class="btn btn-info btn-sm">
								<i class="fa fa-ban"></i> <span>{{ _("Cancel current processes") }}</span>
							</button>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="modal fade" id="addPackageModal" tabindex="-1">
			<div class="modal-dialog modal-lg">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
						<h4 class="modal-title" id="myModalLabel">{{ _("Add Package") }}</h4>
					</div>
					<form class="form-horizontal" role="form">
						<div class="modal-body">
							<div class="form-group">
								<label for="title" class="col-sm-2 control-label">{{ _("Package Name") }}:</label>
								<div class="col-sm-10">
									<input class="form-control" id="title" placeholder="{{ _('Nice movie to process') }}" />
								</div>
							</div>
							<div class="form-group">
								<label for="filename" class="col-sm-2 control-label">{{ _("File Path(s)") }}:</label>
								<div class="col-sm-10">
									<ul id='filename' style='min-height: 25px; word-wrap: break-word;'></ul>
									<a href='javascript:;' onclick='_filemanager();' class='btn btn-info btn-sm col-xs-12'>{{ _("Browse") }}</a>
								</div>
							</div>
							<div class="form-group">
								<label for="target" class="col-sm-2 control-label">{{ _("Target") }}:</label>
								<div class="col-sm-10">
									<div class="radio">
										<label>
											<input type="radio" name="target" id="target_queue" value="1" checked="checked" />
											{{ _("Queue") }}
										</label>
									</div>
									<div class="radio">
										<label>
											<input type="radio" name="target" id="target_collector" value="0" />
											{{ _("Collector") }}
										</label>
									</div>
								</div>
							</div>
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-danger" data-dismiss="modal">
								<i class="fa fa-ban fa-fw"></i> {{ _("Cancel") }}
							</button>
							<button type="submit" class="btn btn-success">
								<i class="fa fa-fw fa-plus"></i> {{ _("Add") }}
							</button>
						</div>
					</form>
				</div>
			</div>
		</div>
		{% endif %}
	</body>
</html>